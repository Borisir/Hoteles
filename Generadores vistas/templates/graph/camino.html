{% extends 'template.html' %}

{% block content %}
<!-- Contenedor principal centrado con tarjeta -->
<div class="container d-flex justify-content-center p-4">
    <div class="card bg-dark text-white w-75 p-4 shadow-lg">
        
        <!-- Título centrado -->
        <h1 class="text-center text-primary mb-4">Ejecutar Algoritmos de Grafos</h1>

        <!-- Contenedor principal con dos columnas: BFS a la izquierda, Camino Corto a la derecha -->
        <div class="row mb-4">
            <!-- Sección de Ejecutar BFS (izquierda) -->
            <div id="bfsSection" class="col-md-6">
                <h2 class="text-center text-primary">Ejecutar DFS</h2>
                <form id="bfsForm">
                    <div class="mb-3">
                        <label for="origen" class="form-label">Origen:</label>
                        <select id="origen" name="origen" class="form-select bg-secondary text-white">
                            {% for list in data %}
                                <option value="{{ list.labelId }}">{{ list.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">Ejecutar BFS</button>
                </form>
            </div>

            <!-- Sección de Calcular Camino Corto (derecha) -->
            <div id="caminoCortoSection" class="col-md-6">
                <h2 class="text-center text-primary">Calcular Camino Corto</h2>
                <form id="caminoCortoForm">
                    <div class="mb-3">
                        <label for="origen" class="form-label">Origen:</label>
                        <select id="origen" name="origen" class="form-select bg-secondary text-white">
                            {% for list in data %}
                                <option value="{{ list.labelId }}">{{ list.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="destino" class="form-label">Destino:</label>
                        <select id="destino" name="destino" class="form-select bg-secondary text-white">
                            {% for list in data %}
                                <option value="{{ list.labelId }}">{{ list.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="algoritmo" class="form-label">Algoritmo:</label>
                        <select id="algoritmo" name="algoritmo" class="form-select bg-secondary text-white">
                            <option value="1">Bellman-Ford</option>
                            <option value="2">Floyd-Warshall</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">Calcular Camino Corto</button>
                </form>
            </div>
        </div>

        <!-- Mostrar resultados en el centro, debajo de los formularios -->
        <div id="result" class="text-center d-none">
            <h2 class="text-danger">Resultado:</h2>
            <p id="resultadoText" class="text-light"></p>
        </div>
    </div>
</div>

<script>
    // BFS Form Submission
    document.getElementById("bfsForm").addEventListener("submit", function(event) {
        event.preventDefault();
        const origen = document.getElementById("origen").value;

        fetch(`/dfs/${origen}`)
            .then(response => response.json())
            .then(data => {
                if (data) {
                    document.getElementById("resultadoText").textContent = data.respuesta;
                    document.getElementById("result").classList.remove("d-none");
                } else {
                    document.getElementById("resultadoText").textContent = "Error: No se pudo ejecutar BFS.";
                    document.getElementById("result").classList.remove("d-none");
                }
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById("resultadoText").textContent = "Error de conexión.";
                document.getElementById("result").classList.remove("d-none");
            });
    });

    // Camino Corto Form Submission
    document.getElementById("caminoCortoForm").addEventListener("submit", function(event) {
        event.preventDefault();
        const origen = document.getElementById("origen").value;
        const destino = document.getElementById("destino").value;
        const algoritmo = document.getElementById("algoritmo").value;

        fetch(`/caminocorto/${origen}/${destino}/${algoritmo}`)
            .then(response => response.json())
            .then(data => {
                if (data.msg === "Camino corto calculado exitosamente") {
                    document.getElementById("resultadoText").textContent = data.resultado;
                    document.getElementById("result").classList.remove("d-none");
                } else {
                    document.getElementById("resultadoText").textContent = "Error: " + data.msg;
                    document.getElementById("result").classList.remove("d-none");
                }
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById("resultadoText").textContent = "Error de conexión.";
                document.getElementById("result").classList.remove("d-none");
            });
    });
</script>

{% endblock %}
